# Публикация приложений

**Типы service**

Типы сервисов, которые есть в kubernetes:
* ClusterIP
* NodePort
* LoadBalancer
* ExternalName
* ExternalIPs
* Headless

_ClusterIp_ - используется для внутрикластерного взаимодействия
Необходимо совпадение label у подов с selector.app
Поды и сервисы должны находиться в одном namespace, но обращаться к сервису можно извне(др. namespace)

_NodePort_ - используется, чтобы прокинуть наружу приложение.
При создании сервиса такого типа на каждой ноде воркера создастся правило, которое будет транслировать
весь трафик, приходящий на некий порт снаружи в приложение
Порт открывается в диапазоне от 3000 до 32676 ?
Кейсы: снаружи кластера есть некий балансировщик, который пробрасывает порты в кластер

_LoadBalancer_ - используется преимущественно в облачных технологиях. Позволяет легко и прозрачно пробрасывать приложение вовне.
Когда данный тип сервиса создается в кластере, он у себя создает балансировщик, который принимает трафик и отправляет его внутрь кластера

_ExternalIPs_ - рпавило, похожее на nodePort, только с указанием ip адреса

_Headless_ - не указан clusterIP, те этому сервису не присваивается ip address 

На физическом уровне сервис представляет собой ipTables/ IP Virtual Server.
При создании service на всех нодах кластера создается правило для ipTables.

## Ingress

Ingress - тип объектов, позволяющих выставить свои сервисы наружу.
Ingress Controller - сервер, работающий в кластере, который запущен в нескольких репликах(не всегда),
отправляющий запросы в приложения, расположенные в кластере

_Annotations_ помогает отправлять "сигналы" приложению, помогает обойти строгую валидацию kubernetes.
Список всех аннотаций при конфигурации nginx: https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/



**Полезно**
Команда kubectl port-forward service/my-service 10000:80 прокидывает сервис на локальную машинку


